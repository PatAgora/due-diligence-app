<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}Scrutinise{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    {% block head %}{% endblock %}
    <style>
      :root{ --sidebar-w:240px; --sidebar-bg:#0b1320; --sidebar-link:#c7cfdb; --sidebar-link-active:#ffffff; --page-bg:#f9fafb; --brand-orange:#f59e0b; }
      html, body{ height:100%; } body{ background:var(--page-bg); }
      .sidebar-nav{ position:fixed; top:0; left:0; bottom:0; width:var(--sidebar-w); background:#0b1320; color:#eef2f7; display:flex; flex-direction:column; z-index:1040; box-shadow:2px 0 12px rgba(0,0,0,.2); }
      .sidebar-brand{ font-weight:800; letter-spacing:.5px; padding:16px 18px; margin:0; border-bottom:1px solid rgba(255,255,255,.06); }
      .brand-orange{ color:var(--brand-orange); }
      .sidebar-content{ padding:8px 12px 16px; overflow-y:auto; }
      .sidebar-content .nav-link{ display:flex; align-items:center; gap:.5rem; color:var(--sidebar-link); border-radius:10px; padding:10px 12px; }
      .sidebar-content .nav-link:hover{ background:rgba(255,255,255,.06); color:var(--sidebar-link-active); }
      .sidebar-content .nav-link.active{ background:rgba(255,255,255,.12); color:var(--sidebar-link-active); }
      .content-wrap{ min-height:100%; margin-left:var(--sidebar-w); padding:20px 24px; }
      @media (max-width:992px){ .sidebar-nav{ position:static; width:100%; height:auto; box-shadow:none; } .content-wrap{ margin-left:0; } }
      .soft-card{ border:1px solid #eef1f5; border-radius:16px; background:#fff; box-shadow:0 2px 8px rgba(16,24,40,.06); }
    </style>
  
<style>
  .scrutinise-brand {
    display:inline-block;
    position:relative;
    font-weight:800;
    font-size:1.4rem;
    color:#ffffff !important;
    letter-spacing:0.2px;
  }
  .scrutinise-brand .underbar {
    display:block;
    height:6px;
    width:100%;
    background:#ff8a33; /* orange from screenshot */
    border-radius:2px;
    margin-top:6px;
  }
  /* Ensure navbar background supports the white wordmark */
  .navbar.scrutinise-dark, .navbar.navbar-dark.bg-dark {
    background-color:#1f242b !important; /* deep charcoal */
  }
</style>

</head>
  <body>
    {% if not request.path.startswith('/login') %}
{% if not request.path.startswith('/login') %}
<nav class="sidebar-nav scrutinise-dark">
      <div class="sidebar-brand"><span class="scrutinise-brand">Scrutinise<span class="underbar"></span></span></div>
      <div class="sidebar-content">
        {% block navbar %}

{# Global, role-aware Dashboard link (single source of truth) #}
{% set _role = (session.get('role') or '')|lower %}
{% if 'operations_manager' in _role %}
  <a class="nav-link {% if request.path.startswith('/operations_dashboard') %}active{% endif %}" href="{{ url_for('operations_dashboard') }}">
    <i class="bi bi-speedometer2"></i> Dashboard
  </a>
{% elif 'team_lead' in _role or 'team leader' in _role %}
  
{% elif 'reviewer' in _role %}
  
{% else %}
  
{% endif %}



{# Global role-aware Dashboard link (visible on every page) #}
{% set _role = (session.get('role') or '')|lower %}
{% if 'operations_manager' in _role %}
{% elif 'team_lead' in _role or 'team leader' in _role %}
  
{% elif 'reviewer' in _role %}
  
{% else %}
{% endif %}


{% if request.path.startswith('/reviewer_dashboard') or request.path.startswith('/reviewer_panel') %}
  
  <a class="nav-link {% if request.path.startswith('/my_tasks') %}active{% endif %}" href="{{ url_for('my_tasks', status='wip', date_range='all') }}">
    <i class="bi bi-list-check"></i> My Tasks
  </a>
{% endif %}


        {% if request.path.startswith('/operations_dashboard') %}{% endif %}
        {% if request.path.startswith('/operations_dashboard') %}<a class="nav-link" href="{{ url_for('planning') }}"><i class="bi bi-calendar3"></i> Planning</a>{% endif %}
{% endblock %}
      </div>
    
      <div class="mt-auto px-2 pb-3">
        <a class="nav-link text-danger d-flex align-items-center gap-2" href="{{ url_for('logout') }}">
          <i class="bi bi-box-arrow-right"></i><span>Logout</span>
        </a>
      </div>

    </nav>
{% endif %}
{% endif %}
    <main class="content-wrap">{% block content %}{% endblock %}</main>
    {% block modals %}{% endblock %}
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    {% block scripts %}{% endblock %}
  </body>
</html>
